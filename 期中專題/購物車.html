<!DOCTYPE html>
<html lang="zh-hant">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="浪草植人|植物｜種子｜盆栽｜希望小小的綠色生命可以療癒你的心。">
    <meta name="keywords" content="浪草植人">
    <title>購物車</title>
    <link rel="shortcut icon" type="image/png" href="./圖片/logo1.png">
    <link rel="stylesheet" type="text/css" href="./固定樣式.css">
    <script src="https://code.jquery.com/jquery-3.6.3.min.js"></script>
    <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.js"></script>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css">
    <style type="text/css">
      a:hover, a:active {
        cursor: url(https://cur.cursors-4u.net/nature/nat-10/nat967.cur), auto !important;
      }
    </style>
    <a href="https://www.cursors-4u.com/cursor/2011/12/04/leaf-20.html" target="_blank" title="Leaf">
      <img src="https://cur.cursors-4u.net/cursor.png" border="0" alt="Leaf" style="position:absolute; top: 0px; right: 0px;">
    </a>
	<style>
		.tablestyle {
		  margin-left: 225px;
		  font-size: 18px;
		}
	  
		.tablestyle td {
		  padding: 5px; /* 設定 td 元素的內距，增加可讀性 */
      border-bottom: 1px solid gray;
		}

		.textstyle {
			text-align: center;
		}

		.imgstyle {
			width: 10px;
			height: 10px;
		}
	</style>
  <script>
    $(function() {
      const mykey = 'cartItems';
      let cartItems = JSON.parse(localStorage.getItem(mykey)) || [];

      let tbody = $('table.tablestyle tbody');
      let total = 0;

      cartItems.forEach(function(item) {
        let tr = $('<tr>');

        let td1 = $('<td style="text-align: center; font-size: 16px">').text(item.name);
        tr.append(td1);

        let td2 = $('<td style="text-align: center;">').html(`<img style="height: 100px" src="${item.img}" alt="${item.name}">`);
        tr.append(td2);

        let td3 = $('<td style="text-align: center;">');
        let qtyInput = $('<input style="text-align: center; width: 100px;" type="number" min="1" value="' + item.qty + '">');
        qtyInput.on('input', function() {
          let newQty = parseInt(qtyInput.val());
          if (newQty >= 1) {
            item.qty = newQty;
            localStorage.setItem(mykey, JSON.stringify(cartItems));
            // 更新總金額
            total = 0;
            cartItems.forEach(function(item) {
              total += item.price * item.qty;
            });
            $('span.total').text('NT$' + total);
            // 更新單項商品總金額
            let subTotal = item.qty * item.price;
            td4.text('NT$' + subTotal);
          }
        });
        td3.append(qtyInput);

        let td4 = $('<td style="text-align: center; font-size: 16px">').text('NT$' + item.price);
        tr.append(td4);

        let td5 = $('<td style="width: 70px;">');
        let removeBtn = $('<button style="margin-left: 14px;">刪除</button>');
        removeBtn.on('click', function() {
          let index = cartItems.findIndex(function(i) { return i.name === item.name });
          if (index >= 0) {
            cartItems.splice(index, 1);
            localStorage.setItem(mykey, JSON.stringify(cartItems));
            tr.remove();
            // 更新總金額
            total -= item.price * item.qty;
            $('span.total').text('NT$' + total);
          }
        });
        td5.append(removeBtn);

        tr.append(td3);
        tr.append(td4);
        tr.append(td5);

        tbody.append(tr);
        total += item.price * item.qty;
      });

      // 顯示總金額
      $('span.total').text('NT$' + total);
    });
  </script>
  </head>
  <body>
    <div class="divposition">
      <a href="./登入會員.html" class="radiusBorder" id="member"><span>登入會員</span></a> 
      <a href="./購物車.html" class="radiusBorder" id="shoppingcar"><span>購物車</span></a> 
      <a href="./聯絡我們.html" class="radiusBorder" id="connect"><span>聯絡我們</span></a> 
    </div>
    <br>
    <br>
    <div style="text-align: center">
      <a href="/期中專題/首頁/首頁.html">
        <img src="./圖片/浪草植人.png" alt="浪草植人" style="max-width:100%; height:auto">
      </a>
    </div>
    <img src="./圖片/Love Plants.png" alt="Love Plants" style="display: block; margin: auto; max-width:100px; height:auto">
    <br>
    <br>
    <div class="menu-container">
      <ul class="menu">
        <li>
          <a href="/期中專題/1關於我們/我們.html" class="menutext">關於我們</a>
        </li>
        <li>
          <a href="/期中專題/2療癒植物/植物.html" class="menutext">療癒植物</a>
        </li>
        <li>
          <a href="/期中專題/3迷人種子/種子.html" class="menutext">迷人種子</a>
        </li>
        <li>
          <a href="/期中專題/4暖心盆栽/盆栽.html" class="menutext">暖心盆栽</a>
        </li>
        <li>
          <a href="/期中專題/5購物須知/須知.html" class="menutext">購物須知</a>
        </li>
        <li>
          <a href="/期中專題/6聊聊栽種/栽種.html" class="menutext">聊聊栽種</a>
        </li>
      </ul>
    </div>
    <br>
    <br>
    <h2 style="text-align: center;">購 物 車 清 單</h2>
    <br>
    <table class="tablestyle">
      <tr>
        <td style="text-align: center; width: 150px; font-size: 17px;">商品名稱</td>
        <td style="text-align: center; width: 150px; font-size: 17px;">商品圖片</td>
        <td style="text-align: center; width: 150px; font-size: 17px;">訂購數量</td>
        <td style="text-align: center; width: 150px; font-size: 17px;">金額</td>
        <td></td>
      </tr>	
    </table>
    <br>
    <div style="font-size:18px; margin-left: 760px; margin-top: 10px; color: red;">
      <b>合計：<span class="total"></span></b>
    </div>
    <br>
    <br>
    <a href="./結帳畫面.html"><button style="margin-left: 780px; width: 7%; font-size: 14px;">前往結帳</button></a>
    <br>
    <br>
    <br>
    <hr>
    <div style="text-align: center; margin-left: 60px">
      <a href="https://www.instagram.com/laiveitsai/"><img style="width: 3.1%; margin-right: 20px; margin-bottom: 50px;" src="./圖片/IG圖案.png" alt="IG圖案"></a>
      <a href="https://www.facebook.com/laiveitsai/?locale=zh_TW"><img style="width: 3%; margin-right: 40px; margin-bottom: 50px;" src="./圖片/FB圖案.png" alt="FB圖案"></a>
      <footer class="information">
        <p>客服時間 | Mon. to Fri. 9:30 ~ 18:30</p>
        <br>
        <p>聯絡電話 | 04-2680-3955</p>
        <br>
        <p>工作室 | 台中市大甲區德興路165號</p>
        <br>
        <p>信箱 | laiveitsai@gmail.com</p>
        <br>
      </footer>
      <span style="margin-right: 30px;"></span>
      <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3634.8697874557865!2d120.62190089999999!3d24.3510281!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x34690e00eec62983%3A0x57286d95ff907fd7!2zNDM35Y-w5Lit5biC5aSn55Sy5Y2A5b636IiI6LevMTY16Jmf!5e0!3m2!1szh-TW!2stw!4v1680615907317!5m2!1szh-TW!2stw" 
        width="250" height="120" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade">
      </iframe>
    </div>
    <div>
      <a href="#top"><img class="up" src="./圖片/向上箭頭.jpg" alt="回到最上面"></a>
    </div>
  </body>
</html>